# Blind SQL Injection

← [Back to Tutorial Index](../README.md#-tutorial-index)

## Overview

This tutorial introduces blind SQL injection, a technique used when the application doesn't display database errors or query results directly. Instead of seeing data in the response, attackers ask the database true/false questions and observe the application's behavior to infer information one bit at a time.

**What you'll learn:**
- How blind SQL injection differs from traditional SQL injection
- Boolean-based blind SQL injection techniques
- How to extract data character by character using TRUE/FALSE conditions
- Automating blind SQL injection with Python scripts

## Getting Started

**Target Application:** All exercises in this tutorial use the vulnerable status page.

**Before you begin:**
1. Ensure the application is running at [http://localhost:5000](http://localhost:5000)
2. Navigate to the Status page at [http://localhost:5000/status](http://localhost:5000/status)
3. Login as Alice

**How it works:** Unlike the search page where results are displayed, the status page only shows payment information if the query returns a valid result. We'll use this TRUE/FALSE behavior to extract sensitive data.

---

## 1. Understand Boolean-based blind SQL injection

> [!NOTE]
> **Key Concept:** Blind SQL injection exploits the application's different responses to TRUE and FALSE SQL conditions. By crafting queries that return TRUE or FALSE, and observing how the application behaves differently, attackers can extract data one character at a time without seeing the actual database results.

**Test the baseline behavior:**

1. Enter a valid payment ID to see what a TRUE condition looks like:
   - Query: `1`
   - Result: Payment details are displayed (TRUE condition)

2. Test a TRUE logical statement:
   - Query: `1 AND 1=1`
   - Result: Payment details still shown (TRUE AND TRUE = TRUE)

3. Test a FALSE logical statement:
   - Query: `1 AND 1=2`
   - Result: No payment details shown (TRUE AND FALSE = FALSE)

**Key observation:** We can now ask TRUE/FALSE questions by injecting conditions into the query!

## 2. Extract the first character of a password

> [!NOTE]
> **Key Concept:** The `SUBSTRING()` function allows us to extract individual characters from a string. By comparing each character against all possible values (a-z, 0-9, etc.) and observing TRUE/FALSE responses, we can determine the actual character at that position.

1. Ask if the first character of the admin's password hash is 'a':
   - Query: `1 AND (SELECT SUBSTRING(password_hash, 1, 1) FROM users WHERE username='admin') = 'a'`
   - If payment is shown: the first character is 'a'
   - If no payment shown: the first character is NOT 'a'

2. Try different characters until you get a TRUE result:
   - Query: `1 AND (SELECT SUBSTRING(password_hash, 1, 1) FROM users WHERE username='admin') = 'b'`
   - Query: `1 AND (SELECT SUBSTRING(password_hash, 1, 1) FROM users WHERE username='admin') = 'c'`
   - Continue until the payment details appear

3. Once you find the correct first character, move to position 2:
   - Query: `1 AND (SELECT SUBSTRING(password_hash, 2, 1) FROM users WHERE username='admin') = 'a'`

## 3. Understanding the manual extraction process

> [!NOTE]
> **Key Concept:** MD5 password hashes are 32 hexadecimal characters (0-9, a-f). To manually extract a complete hash, you would need to test up to 16 possible characters for each of the 32 positions - potentially requiring hundreds of requests. This is why automation is essential for blind SQL injection.

**The challenge:**
- MD5 hash length: 32 characters
- Possible characters per position: 16 (0-9, a-f)
- Maximum requests needed: 32 × 16 = 512 requests

**Manual steps to extract the full hash:**
1. For position 1, test characters: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, a, b, c, d, e, f
2. When you find a TRUE response, note that character
3. Move to position 2 and repeat
4. Continue for all 32 positions

## 4. Automate the extraction with Python

> [!NOTE]
> **Key Concept:** The provided Python script automates the character-by-character extraction process. It systematically tests each position of the password hash against all possible hexadecimal characters, looks for the "Payment Found" text in the response to detect TRUE conditions, and builds the complete hash automatically.

**How the automation works:**

The script follows this algorithm:
1. **Login:** Establishes a session by logging in as Alice
2. **Character set:** Defines possible characters as `"0123456789abcdef"`
3. **Position loop:** For each of the 32 positions in the MD5 hash:
   - **Character test:** Try each character (0-9, a-f) at the current position
   - **Inject payload:** `1 AND (SELECT SUBSTRING(password_hash, {position}, 1) FROM users WHERE username='admin') = '{char}'`
   - **Check response:** Look for "Payment Found" in the HTTP response
   - **TRUE condition:** When found, append that character to the extracted hash
   - **Next position:** Move to the next character position
4. **Output:** Display the complete 32-character password hash

**Run the automated extraction:**

```bash
python3 ./demo_scripts/exploit_blind_sqli.py
```

**Expected output:**
```
============================================================
  BLIND SQL INJECTION - Simple Demo
============================================================

[1] Logging in as alice...
    ✓ Logged in

[3] Extracting password hash for 'admin'...
    (This tests each character 0-9, a-f)

    Position  1: '5' ✓ → 5
    Position  2: 'f' ✓ → 5f
    Position  3: '4' ✓ → 5f4
    ...
    Position 32: 'c' ✓ → 5f4dcc3b5aa765d61d8327deb882cf99

[+] EXTRACTED HASH: 5f4dcc3b5aa765d61d8327deb882cf99
```

## 5. Crack the password hash

> [!NOTE]
> **Key Concept:** Password hashes can often be reversed using rainbow tables - precomputed databases of hashes and their corresponding plaintext passwords. Online services like CrackStation maintain massive rainbow tables for common hashing algorithms like MD5.

1. Copy the extracted hash from the script output
2. Navigate to [https://crackstation.net](https://crackstation.net)
3. Paste the hash and click "Crack Hashes"
4. The service will reveal the plaintext password (if it's in their database)

## 6. Login as the admin user

> [!NOTE]
> **Key Concept:** This final step demonstrates the complete attack chain - from discovering a blind SQL injection vulnerability, to extracting password hashes character by character, to cracking the hash, and finally gaining unauthorized access to a privileged account.

1. Logout from Alice's account
2. Go to the login page
3. Enter username: `admin`
4. Enter the password obtained from CrackStation
5. You now have administrative access to the application

**Impact:** Through blind SQL injection, an attacker gained:
- Ability to extract any data from the database (even without seeing query results)
- Access to password hashes
- Credentials for the highest privileged account
- Complete control over the application

---

## Next Steps

**Congratulations!** You've completed the Blind SQL Injection tutorial.

**Continue your learning:**
- **Previous Tutorial:** [1. Introduction to SQL Injection](./1.%20INTRO%20TO%20SQL%20INJECTION.MD) - Review UNION-based injection techniques
- **Next Tutorial:** [3. Advanced Techniques](./3.%20ADVANCED%20TECHNIQUES.md) - Learn to escalate to full system compromise

← [Back to Tutorial Index](../README.md#-tutorial-index)
